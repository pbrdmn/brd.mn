<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Getting started with Test Driven Development / brd.mn</title>
  <meta name="description" content="Explore the ideas of Test Driven Development and how it assists testing and code coverage">
  <link rel="canonical" href="https://brd.mn/articles/tdd/">
  <link rel="alternate" type="application/rss+xml" title="RSS"
      href="https://brd.mn/rss.xml"><link rel="icon" href="https://brd.mn/images/logo@1x.jpg">
<meta name="theme-color" content="#fff">
<meta name="theme-color" content="#888488" media="(prefers-color-scheme: dark)">

<meta property="og:title" content="Getting started with Test Driven Development">
<meta property="og:description" content="Explore the ideas of Test Driven Development and how it assists testing and code coverage">
<meta property="og:type" content="article">
<meta property="og:url" content="https://brd.mn/articles/tdd/">
<meta property="og:site_name" content="brd.mn">
<meta property="article:author" content="Philip Boardman">
<meta property="article:published_time" content="Wed Jul 13 2016 10:00:00 GMT+1000 (Australian Eastern Standard Time)">
<meta property="og:image" content="https://brd.mn/images/logo@10x.jpg">
  
  <style>:root{--foreground:#564b57;--background:#fff;--background2:#f3f2f4;--code-background:#3b3b3b;--link:#015fb6;--visited:#6c0b77}@media screen and (prefers-color-scheme:dark){:root{--foreground:#888488;--background:#050305;--background2:#160d16;--link:#5282c9;--visited:#8d71a3;--code-background:#030203}img{opacity:.7}}html{font-family:sans-serif;line-height:1.3;color:var(--foreground);background:var(--background)}@media (min-width:600px){html{font-size:1.125rem}}@media (min-width:900px){html{font-size:1.25rem}}body{margin:0 0 3rem;padding:0}main{padding:0 1rem;max-width:36rem;margin:1rem auto}a{color:var(--link)}a:visited{color:var(--visited)}a.logo{display:flex;align-items:center;flex-direction:row;text-decoration:none;color:var(--foreground)}a.logo img{margin-right:.5rem}h1,h2{font-weight:400}article.snippet{display:flex;margin:1rem 0 2rem}.snippet .thumb{margin-left:1rem;flex:1}.snippet .summary{flex:3}.snippet .summary h2{font-size:inherit;font-weight:inherit;margin:0}.snippet .summary p{margin:.5rem 0}footer{font-size:.8rem}footer>p{margin:.5rem 0}@media screen and (max-width:599px){article>img,header>img{margin:0 -1rem;width:calc(100% + 2rem);max-width:calc(100% + 2rem);border-radius:0}.snippet{flex-direction:column-reverse}.snippet .thumb{margin:0 0 .5rem}.snippet .thumb img{width:100%}}blockquote,pre{background:var(--background2);padding:1rem;margin:1rem -1rem;overflow:hidden}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}code{background:var(--background2)}@media print,(prefers-contrast:more){blockquote,pre{background:var(--background);outline:2px solid var(--background2)}}pre{white-space:pre-wrap;word-break:break-all}img{max-width:100%;height:auto;border-radius:.2rem}hr{height:.1rem;width:90%;background:var(--background2);border:0;margin:2rem auto}nav ul{margin:1rem 0;padding:0;display:flex;flex-wrap:wrap}nav li{list-style:none}nav li a{margin-right:1rem}@media (min-width:600px){blockquote,pre{border-radius:.5rem}pre[class*=language-]{border-radius:.3em}}@media print{:root{--foreground:#000;--background2:#fff}html{font-size:14px}main{max-width:100%}}</style>
      <link rel="stylesheet" type="text/css" href="/css/code.css">
  <script src="/js/timeAgo.js" defer></script>
</head>
  <body>
    <main>
      <h1><a class="logo" href="/" title="brd.mn"><img
      src="/images/logo@2x.webp"
      srcset="/images/logo@1x.webp 1x, /images/logo@2x.webp 2x, /images/logo@3x.webp 3x"
      width="64"
      height="64" 
      alt="Philip Boardman"
    > Philip Boardman</a></h1>

      <article>
  <header>
    <h1>Getting started with Test Driven Development</h1>
  </header>

  <footer>
    Published <time datetime="2016-07-13" title="Published on 2016-07-13">on 2016-07-13</time>
    in 
      <a href="/tags/javascript/">#javascript</a>
    
      <a href="/tags/testing/">#testing</a>
    
      <a href="/tags/tdd/">#tdd</a>
    
      <a href="/tags/programming/">#programming</a>
    
      <a href="/tags/code/">#code</a>
    
  </footer>

  <hr>

  <p>The <em>Test Driven Development</em> pattern instructs that tests are written first. Each test should describe the desired functionality and initially fail. After each test has been written, only the minimum code to pass the test is written.</p>
<h2>Our Environment</h2>
<p>We will be writing a JavaScript <code>Users</code> class using the <a href="https://www.sencha.com/products/extjs">Ext JS framework</a> and testing with the <a href="https://www.sencha.com/products/test">Sencha Test Studio</a>. These tests are written in Jasmine and usually stored in a <code>/test</code> directory alongside the <code>/app</code> directory where the application code will be written.</p>
<h2>Our First Test</h2>
<p>Our first test will simply create a class object and assert that it is <em>defined</em> (i.e. not null).</p>
<pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should be defined'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> users <span class="token operator">=</span> Ext<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'MyApp.main.Users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Running the test now will fail, of course, because we haven’t yet defined the <code>Users</code> class. We can stub out a class using the Ext.define() method. This is application code so it will be written in the <code>/app</code> or <code>/src</code> directory.</p>
<pre class="language-js"><code class="language-js">Ext<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'MyApp.main.Users'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We’ve written one line of code, our test passes and we’re done.</p>
<h2>Adding a Second Test</h2>
<p>Now that we have started our <code>Users</code> class, we can add some functionality to it. Our second test will assert that the <code>Users.getUsers()</code> method returns an empty array before any users have been added.</p>
<pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">/// ...</span><br>  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'getUsers() method'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an array'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token function">expect</span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>With the Ext JS library at our disposal, we can add this functionality to our class quite quickly by declaring a users configuration property and defining it as an empty array. Ext JS will automatically provide getters and setters for this property, which <code>Users.getUsers()</code> will call.</p>
<pre class="language-js"><code class="language-js">Ext<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'MyApp.main.Users'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Our second test now passes.</p>
<h2>Writing a Third Test</h2>
<p>Our third test will add a user to our <code>users</code> array property. We describe the desired functionality in a test.</p>
<pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'addUser() method'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should add user by string'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> users <span class="token operator">=</span> Ext<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'MyApp.main.Users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    users<span class="token punctuation">.</span><span class="token function">AddUser</span><span class="token punctuation">(</span><span class="token string">'first user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'first user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Again, after running the test it will initially fail. We can now add this functionality to our class, but only enough to pass the test.</p>
<p>We create an <em>addUser</em> method taking a parameter and pushing this onto the <em>users</em> array property.</p>
<pre class="language-js"><code class="language-js"><span class="token function-variable function">addUser</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Running the test again and our test user is added to the array and the value returned by <code>users.getUsers()</code> is now equal to <code>['first user']</code> and our test passes.</p>
<h2>Write More Tests</h2>
<p>Proceeding in this way, we write a test to describe the behaviour of each <em>public</em> function. We are building up a library of tests which prove that our code meets the requirements. These tests are <em>Unit Tests</em>, which help focus our development through <em>TDD</em> and provide <em>Regression Testing</em>. After each code change, all tests are run and we can quickly identify if the changes have any side-effects introducing bugs in other areas of the application.</p>
<p>Repeating the object creation in each test is a waste of code, we can use some of Jasmine’s built-in methods to create a fresh copy for each test. We move the <code>users</code> declaration outside the tests and create an instance of the class using <code>beforeEach</code>, which runs before each test and destroy the object after each test with <code>afterEach</code>.</p>
<pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br><br>  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    users <span class="token operator">=</span> Ext<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'MyApp.main.Users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    users<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    users <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">//...</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>One other technique to improve these test is to clearly spell out the test’s expected and actual values. By defining an <code>expected</code> and <code>actual</code> variable, future testers can quickly identify the purpose and required output for each test. For example, we could rewrite our <code>addUsers</code> test as:</p>
<pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'addUser() method'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should add user by string'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    users<span class="token punctuation">.</span><span class="token function">AddUser</span><span class="token punctuation">(</span><span class="token string">'first user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> expected <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'first user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> actual <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We can now build up a library of tests for our class.</p>
<ol>
<li>Take a business rule and write a failing test</li>
<li>Write only the code required and check that the test passes</li>
<li>Repeat</li>
</ol>

</article>
    </main>
  </body>
</html>
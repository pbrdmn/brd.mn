<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Adding automatic dark mode to a website / brd.mn</title>
  <meta name="description" content="Implementing dark mode in a website using css variables and prefers-color-scheme media query">
  <link rel="canonical" href="https://brd.mn/articles/dark-mode-with-css-variables/">
  <link rel="alternate" type="application/rss+xml" title="RSS"
      href="https://brd.mn/rss.xml"><link rel="icon" href="https://brd.mn/images/logo@1x.jpg">
<meta name="theme-color" content="#fff">
<meta name="theme-color" content="#888488" media="(prefers-color-scheme: dark)">

<meta property="og:title" content="Adding automatic dark mode to a website">
<meta property="og:description" content="Implementing dark mode in a website using css variables and prefers-color-scheme media query">
<meta property="og:type" content="article">
<meta property="og:url" content="https://brd.mn/articles/dark-mode-with-css-variables/">
<meta property="og:site_name" content="brd.mn">
<meta property="article:author" content="Philip Boardman">
<meta property="article:published_time" content="Sun Mar 27 2022 11:00:00 GMT+1100 (Australian Eastern Daylight Time)">
<meta property="og:image" content="https://brd.mn/articles/dark-mode-with-css-variables/dark-mode.png">
  
  <style>:root{--foreground:#564b57;--background:#fff;--background2:#f3f2f4;--code-background:#3b3b3b;--link:#015fb6;--visited:#6c0b77}@media screen and (prefers-color-scheme:dark){:root{--foreground:#888488;--background:#050305;--background2:#160d16;--link:#5282c9;--visited:#8d71a3;--code-background:#030203}img{opacity:.7}}html{font-family:sans-serif;line-height:1.3;color:var(--foreground);background:var(--background)}@media (min-width:600px){html{font-size:1.125rem}}@media (min-width:900px){html{font-size:1.25rem}}body{margin:0 0 3rem;padding:0}main{padding:0 1rem;max-width:36rem;margin:1rem auto}a{color:var(--link)}a:visited{color:var(--visited)}a.logo{display:flex;align-items:center;flex-direction:row;text-decoration:none;color:var(--foreground)}a.logo img{margin-right:.5rem}h1,h2{font-weight:400}article.snippet{display:flex;margin:1rem 0 2rem}.snippet .thumb{margin-left:1rem;flex:1}.snippet .summary{flex:3}.snippet .summary h2{font-size:inherit;font-weight:inherit;margin:0}.snippet .summary p{margin:.5rem 0}footer{font-size:.8rem}footer>p{margin:.5rem 0}@media screen and (max-width:599px){article>img,header>img{margin:0 -1rem;width:calc(100% + 2rem);max-width:calc(100% + 2rem);border-radius:0}.snippet{flex-direction:column-reverse}.snippet .thumb{margin:0 0 .5rem}.snippet .thumb img{width:100%}}blockquote,pre{background:var(--background2);padding:1rem;margin:1rem -1rem;overflow:hidden}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}code{background:var(--background2)}@media print,(prefers-contrast:more){blockquote,pre{background:var(--background);outline:2px solid var(--background2)}}pre{white-space:pre-wrap;word-break:break-all}img{max-width:100%;height:auto;border-radius:.2rem}hr{height:.1rem;width:90%;background:var(--background2);border:0;margin:2rem auto}nav ul{margin:1rem 0;padding:0;display:flex;flex-wrap:wrap}nav li{list-style:none}nav li a{margin-right:1rem}@media (min-width:600px){blockquote,pre{border-radius:.5rem}pre[class*=language-]{border-radius:.3em}}@media print{:root{--foreground:#000;--background2:#fff}html{font-size:14px}main{max-width:100%}}</style>
      <link rel="stylesheet" type="text/css" href="/css/code.css">
  <script src="/js/timeAgo.js" defer></script>
</head>
  <body>
    <main>
      <h1><a class="logo" href="/" title="brd.mn"><img
      src="/images/logo@2x.webp"
      srcset="/images/logo@1x.webp 1x, /images/logo@2x.webp 2x, /images/logo@3x.webp 3x"
      width="64"
      height="64" 
      alt="Philip Boardman"
    > Philip Boardman</a></h1>

      <article>
  <header>
    <h1>Adding automatic dark mode to a website</h1>
      <img src="dark-mode.png" alt="Experimenting with CSS Variables and prefers-color-scheme media query" title="Experimenting with CSS Variables and prefers-color-scheme media query" width="800" height="450">
  </header>

  <footer>
    Published <time datetime="2022-03-27" title="Published on 2022-03-27">on 2022-03-27</time>
    in 
      <a href="/tags/css/">#css</a>
    
      <a href="/tags/media query/">#media query</a>
    
      <a href="/tags/programming/">#programming</a>
    
      <a href="/tags/code/">#code</a>
    
  </footer>

  <hr>

  <p>CSS variables have become mainstream, but I was too busy with CSS-in-JS solutions for React that I hadn't previously had an opportunity to learn the details or implement them in any environments.</p>
<p>As I reset <a href="/articles/eleventy/" title="Rebuilding with Eleventy">this site</a> I took this opportunity to explore the options available to make use of CSS variables and some of the newer media queries added to browsers in recent years.</p>
<h2>CSS Variables</h2>
<p>To start with, CSS variables are a <em>new</em> way to define properties in CSS. They start with a double-dash, such as <code>--example</code>, and can be assigned to a CSS property using the notation <code>var(--example)</code>.</p>
<p>So to define a variable for particular colour, then apply this colour throughout the rest of the CSS rules can be achieved with.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">--brand-color</span><span class="token punctuation">:</span> #1196cf<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">h1</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--brand-color<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<h2>CSS Variable Scope</h2>
<p>CSS variables also bring scoping. A variable can be defined at any level of the document, such as <code>body</code> in the example above, and will be available to all context below it. Variables which are intended to have <em>global</em> scope, available to the entire document, the <code>:root</code> scope should be used.</p>
<p>The scoping of a variable also applies to definitions and overloading, so a variable may have one value in the global scope and another value in a local scope.</p>
<h2>Prefers Color Scheme: Dark</h2>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme">prefers-color-scheme</a> media query has been added to modern browsers to indicate to a website whether the user has defined a preference for either light or dark color schemes.</p>
<p>This would allow a website to tailor the experience to the user by displaying light text on a dark background by overriding the <code>color</code> and <code>background</code> colours for the page, such as in this example:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span> <span class="token property">background</span><span class="token punctuation">:</span> white <span class="token punctuation">}</span><br><br><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> dark<span class="token punctuation">)</span></span> <span class="token punctuation">{</span><br>  <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span> <span class="token property">background</span><span class="token punctuation">:</span> black <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h2>Combining Prefers Color Scheme and CSS Variables</h2>
<p>Combining these two new techniques would allow a website's theme to be quickly configured for light and dark modes, setting variables to be used for each of the different component colours - or even any CSS property.</p>
<p>Once these variables have been defined, they can be used throughout the rest of the site to set the properties of the elements being rendered on the page.</p>
<p>This example below defines several variables that that are used in the theme of this site, setting variables <code>--foreground</code>, <code>--background</code> and several others for a <em>light mode</em> theme, which are then overridden with a new set of colour values corresponding to a <em>dark mode</em> theme. Also in this example, the dark mode theme would only be applied for <code>screen</code>, so they would not be used in a <code>print</code> context.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">:root</span> <span class="token punctuation">{</span><br>  <span class="token property">--foreground</span><span class="token punctuation">:</span> #3c363d<span class="token punctuation">;</span><br>  <span class="token property">--background</span><span class="token punctuation">:</span> #f4eff5<span class="token punctuation">;</span><br>  <span class="token property">--background2</span><span class="token punctuation">:</span> #e5dfe6<span class="token punctuation">;</span><br>  <span class="token property">--code-background</span><span class="token punctuation">:</span> #0e050e<span class="token punctuation">;</span><br>  <span class="token property">--link</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span><br>  <span class="token property">--visited</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token atrule"><span class="token rule">@media</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> dark<span class="token punctuation">)</span></span> <span class="token punctuation">{</span><br>  <span class="token selector">:root</span> <span class="token punctuation">{</span><br>    <span class="token property">--foreground</span><span class="token punctuation">:</span> #ddd4df<span class="token punctuation">;</span><br>    <span class="token property">--background</span><span class="token punctuation">:</span> #160d16<span class="token punctuation">;</span><br>    <span class="token property">--background2</span><span class="token punctuation">:</span> #241824<span class="token punctuation">;</span><br>    <span class="token property">--link</span><span class="token punctuation">:</span> #8989ff<span class="token punctuation">;</span><br>    <span class="token property">--visited</span><span class="token punctuation">:</span> #e934e9<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Once these variables had been defined, they are used throughout the rest of the site's stylesheet.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">line-height</span><span class="token punctuation">:</span> 1.5rem<span class="token punctuation">;</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--foreground<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--background<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--background<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--background2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">a</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--link<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">a:visited</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--visited<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">code</span> <span class="token punctuation">{</span><br>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--background2<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>

</article>
    </main>
  </body>
</html>